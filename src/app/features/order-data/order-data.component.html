<div class="order-data page-card">
  <!-- Header -->
  <header id="main-content" class="order-data__header" tabindex="-1">
    <h1 class="order-data__title">Megrendel√©si adatok</h1>
    <p class="order-data__subtitle">A leadott rendel√©sb≈ël √∂sszegy≈±jt√∂tt inform√°ci√≥k</p>
    <p class="order-data__date-header" *ngIf="orderData?.orderDate">
      Leadva: {{ orderData?.orderDate | date:'yyyy. MM. dd.' }}
    </p>
  </header>

  <!-- Loading -->
  <div
    class="order-data__loading"
    *ngIf="loading"
    role="status"
    aria-live="polite"
    aria-label="Megrendel√©si adatok bet√∂lt√©se folyamatban">
    <div class="order-data__spinner" aria-hidden="true"></div>
    <p>Adatok bet√∂lt√©se...</p>
    <span class="sr-only">K√©rem v√°rjon, a megrendel√©si adatok bet√∂lt√©se folyamatban van</span>
  </div>

  <!-- Error -->
  <div
    class="order-data__error"
    *ngIf="error && !loading"
    role="alert"
    aria-live="assertive"
    aria-atomic="true">
    <p>{{ error }}</p>
    <button class="order-data__retry-btn" (click)="loadOrderData()">
      √öjrapr√≥b√°lkoz√°s
    </button>
  </div>

  <!-- Empty state -->
  <div
    class="order-data__empty"
    *ngIf="!loading && !error && !orderData"
    role="status"
    aria-label="M√©g nincs leadott megrendel√©s">
    <div class="order-data__empty-icon" aria-hidden="true">üìã</div>
    <p>M√©g nincs leadott megrendel√©s</p>
  </div>

  <!-- Content -->
  <div class="order-data__content" *ngIf="!loading && !error && orderData">

    <!-- Top row: Kapcsolattart√≥ + Iskola √©s oszt√°ly -->
    <div class="order-data__row order-data__row--two-cols">
      <!-- Kapcsolattart√≥ -->
      <section class="order-data__section" *ngIf="orderData.contactName || orderData.contactPhone || orderData.contactEmail">
        <h2 class="order-data__section-title">Kapcsolattart√≥</h2>
        <div class="order-data__list">
          <div class="order-data__item" *ngIf="orderData.contactName">
            <span class="order-data__label">N√©v</span>
            <span class="order-data__value">{{ orderData.contactName }}</span>
          </div>
          <div class="order-data__item" *ngIf="orderData.contactPhone">
            <span class="order-data__label">Telefon</span>
            <span class="order-data__value">{{ orderData.contactPhone }}</span>
          </div>
          <div class="order-data__item" *ngIf="orderData.contactEmail">
            <span class="order-data__label">Email</span>
            <span class="order-data__value">{{ orderData.contactEmail }}</span>
          </div>
        </div>
      </section>

      <!-- Iskola √©s oszt√°ly -->
      <section class="order-data__section">
        <h2 class="order-data__section-title">Iskola √©s oszt√°ly</h2>
        <div class="order-data__list">
          <div class="order-data__item" *ngIf="orderData.schoolName">
            <span class="order-data__label">Iskola</span>
            <span class="order-data__value">{{ orderData.schoolName }}</span>
          </div>
          <div class="order-data__item" *ngIf="orderData.className || orderData.classYear">
            <span class="order-data__label">Oszt√°ly</span>
            <span class="order-data__value">{{ orderData.className }} <span *ngIf="orderData.classYear">({{ orderData.classYear }})</span></span>
          </div>
          <div class="order-data__item" *ngIf="orderData.studentCount || orderData.teacherCount">
            <span class="order-data__label">L√©tsz√°m</span>
            <span class="order-data__value">
              <span *ngIf="orderData.studentCount">{{ orderData.studentCount }} di√°k</span>
              <span *ngIf="orderData.studentCount && orderData.teacherCount">, </span>
              <span *ngIf="orderData.teacherCount">{{ orderData.teacherCount }} tan√°r</span>
            </span>
          </div>
        </div>
      </section>
    </div>

    <!-- Tabl√≥ be√°ll√≠t√°sok -->
    <section class="order-data__section" *ngIf="orderData.color || orderData.fontFamily || orderData.sortType">
      <h2 class="order-data__section-title">Tabl√≥ be√°ll√≠t√°sok</h2>
      <div class="order-data__grid order-data__grid--three">
        <div class="order-data__item" *ngIf="orderData.color">
          <span class="order-data__label">Sz√≠n</span>
          <span class="order-data__value order-data__value--color">
            <span class="order-data__color-swatch" [style.background-color]="orderData.color"></span>
            {{ orderData.color }}
          </span>
        </div>
        <div class="order-data__item" *ngIf="orderData.fontFamily">
          <span class="order-data__label">Bet≈±t√≠pus</span>
          <span class="order-data__value">{{ orderData.fontFamily }}</span>
        </div>
        <div class="order-data__item" *ngIf="orderData.sortType">
          <span class="order-data__label">Rendez√©s</span>
          <span class="order-data__value">{{ orderData.sortType }}</span>
        </div>
      </div>
    </section>

    <!-- Le√≠r√°s -->
    <section class="order-data__section" *ngIf="orderData.description">
      <h2 class="order-data__section-title">Le√≠r√°s / Megjegyz√©sek</h2>
      <div class="order-data__description" [innerHTML]="orderData.description | safeHtml"></div>
    </section>

    <!-- Id√©zet -->
    <section class="order-data__section" *ngIf="orderData.quote">
      <h2 class="order-data__section-title">Id√©zet</h2>
      <blockquote class="order-data__quote">{{ orderData.quote }}</blockquote>
    </section>

    <!-- N√©vsorok - 2 oszlopban -->
    <div class="order-data__row order-data__row--two-cols" *ngIf="orderData.studentDescription || orderData.teacherDescription">
      <!-- Di√°kok n√©vsora -->
      <section class="order-data__section" *ngIf="orderData.studentDescription">
        <h2 class="order-data__section-title">Di√°kok n√©vsora</h2>
        <pre class="order-data__namelist">{{ orderData.studentDescription }}</pre>
      </section>

      <!-- Tan√°rok n√©vsora -->
      <section class="order-data__section" *ngIf="orderData.teacherDescription">
        <h2 class="order-data__section-title">Tan√°rok n√©vsora</h2>
        <pre class="order-data__namelist">{{ orderData.teacherDescription }}</pre>
      </section>
    </div>

    <!-- Jellemz≈ëk (tags) -->
    <section class="order-data__section" *ngIf="hasTags">
      <h2 class="order-data__section-title">Jellemz≈ëk</h2>
      <div class="order-data__tags">
        <span class="order-data__tag" *ngFor="let tag of orderData.tags; trackBy: trackByTag">
          {{ tag }}
        </span>
      </div>
    </section>

    <!-- AI √∂sszefoglal√≥ -->
    <section class="order-data__section" *ngIf="orderData.aiSummary">
      <h2 class="order-data__section-title">AI √∂sszefoglal√≥</h2>
      <p class="order-data__summary">{{ orderData.aiSummary }}</p>
    </section>

    <!-- Footer: PDF gomb + d√°tum -->
    <footer class="order-data__footer">
      <button
        class="order-data__pdf-btn"
        *ngIf="hasPdf"
        (click)="openPdf()"
        [disabled]="generatingPdf"
        [class.order-data__pdf-btn--loading]="generatingPdf">
        <span *ngIf="!generatingPdf">üìÑ Megrendel≈ëlap megtekint√©se</span>
        <span *ngIf="generatingPdf">‚è≥ PDF gener√°l√°sa...</span>
      </button>
      <p class="order-data__date" *ngIf="orderData.orderDate">
        Megrendel√©s leadva: {{ orderData.orderDate | date:'yyyy. MM. dd.' }}
      </p>
    </footer>
  </div>
</div>
