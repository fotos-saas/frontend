<div class="print-tab">
  <!-- Bal oszlop: Státusz idővonal -->
  <div class="print-col print-col--left">
    <section class="timeline-section">
      <h3 class="section-title">
        <lucide-icon [name]="ICONS.CLOCK" [size]="16" />
        Státusz idővonal
      </h3>
      <div class="timeline">
        @if (project()?.inPrintAt) {
          <div class="timeline-item">
            <div class="timeline-dot timeline-dot--purple"></div>
            <div class="timeline-content">
              <span class="timeline-label">Nyomdába adva</span>
              <span class="timeline-date">{{ project()!.inPrintAt | date:'yyyy. MMM d. HH:mm':'':'hu-HU' }}</span>
            </div>
          </div>
        }
        @if (project()?.doneAt) {
          <div class="timeline-item">
            <div class="timeline-dot timeline-dot--green"></div>
            <div class="timeline-content">
              <span class="timeline-label">Kész</span>
              <span class="timeline-date">{{ project()!.doneAt | date:'yyyy. MMM d. HH:mm':'':'hu-HU' }}</span>
            </div>
          </div>
        } @else {
          <div class="timeline-item timeline-item--pending">
            <div class="timeline-dot timeline-dot--gray"></div>
            <div class="timeline-content">
              <span class="timeline-label">Kész</span>
              <span class="timeline-date timeline-date--pending">Folyamatban...</span>
            </div>
          </div>
        }
      </div>
    </section>
  </div>

  <!-- Jobb oszlop: Fájlok -->
  <div class="print-col print-col--right">
    <!-- Kistabló fájl -->
    <section class="file-section">
      <h3 class="section-title">
        <lucide-icon [name]="ICONS.IMAGE" [size]="16" />
        Kistabló
      </h3>
      @if (project()?.printSmallTablo) {
        <div class="file-card">
          <div class="file-info">
            <lucide-icon [name]="state.smallTabloIcon()" [size]="28" class="file-type-icon" />
            <div class="file-details">
              <span class="file-name">{{ project()!.printSmallTablo!.fileName }}</span>
              <span class="file-meta">{{ formatFileSize(project()!.printSmallTablo!.size) }} · Feltöltve: {{ project()!.printSmallTablo!.uploadedAt | date:'yyyy. MMM d.':'':'hu-HU' }}</span>
            </div>
          </div>
          <div class="file-actions">
            <button type="button" class="download-btn" (click)="downloadClick.emit({ type: 'small_tablo' })">
              <lucide-icon [name]="ICONS.DOWNLOAD" [size]="16" />
              Letöltés
            </button>
            <button type="button" class="replace-btn" (click)="smallTabloInput()?.nativeElement?.click()">
              <lucide-icon [name]="ICONS.UPLOAD" [size]="16" />
              Csere
            </button>
            <button type="button" class="delete-btn" (click)="deleteClick.emit({ type: 'small_tablo' })">
              <lucide-icon [name]="ICONS.DELETE" [size]="16" />
            </button>
          </div>
        </div>
      } @else {
        <div
          class="drop-zone"
          [class.drop-zone--drag]="state.draggingSmallTablo()"
          (dragover)="onDragOver($event, 'small_tablo')"
          (dragleave)="onDragLeave($event, 'small_tablo')"
          (drop)="onDrop($event, 'small_tablo')"
          (click)="smallTabloInput()?.nativeElement?.click()"
        >
          <lucide-icon [name]="ICONS.UPLOAD" [size]="32" class="drop-icon" />
          <p class="drop-text">Húzd ide a kistabló fájlt vagy kattints a feltöltéshez</p>
          <p class="drop-hint">PDF, TIFF, PSD, JPG, PNG — max 200 MB</p>
        </div>
      }
      <input
        #smallTabloInputRef
        type="file"
        accept=".pdf,.tiff,.tif,.psd,.jpg,.jpeg,.png"
        class="hidden-input"
        (change)="onFileSelected($event, 'small_tablo')"
      />
    </section>

    <!-- Nyomdai flat fájl -->
    <section class="file-section">
      <h3 class="section-title">
        <lucide-icon [name]="ICONS.FILE_TEXT" [size]="16" />
        Nyomdai flat
      </h3>
      @if (project()?.printFlat) {
        <div class="file-card">
          <div class="file-info">
            <lucide-icon [name]="state.flatIcon()" [size]="28" class="file-type-icon" />
            <div class="file-details">
              <span class="file-name">{{ project()!.printFlat!.fileName }}</span>
              <span class="file-meta">{{ formatFileSize(project()!.printFlat!.size) }} · Feltöltve: {{ project()!.printFlat!.uploadedAt | date:'yyyy. MMM d.':'':'hu-HU' }}</span>
            </div>
          </div>
          <div class="file-actions">
            <button type="button" class="download-btn" (click)="downloadClick.emit({ type: 'flat' })">
              <lucide-icon [name]="ICONS.DOWNLOAD" [size]="16" />
              Letöltés
            </button>
            <button type="button" class="replace-btn" (click)="flatInput()?.nativeElement?.click()">
              <lucide-icon [name]="ICONS.UPLOAD" [size]="16" />
              Csere
            </button>
            <button type="button" class="delete-btn" (click)="deleteClick.emit({ type: 'flat' })">
              <lucide-icon [name]="ICONS.DELETE" [size]="16" />
            </button>
          </div>
        </div>
      } @else {
        <div
          class="drop-zone"
          [class.drop-zone--drag]="state.draggingFlat()"
          (dragover)="onDragOver($event, 'flat')"
          (dragleave)="onDragLeave($event, 'flat')"
          (drop)="onDrop($event, 'flat')"
          (click)="flatInput()?.nativeElement?.click()"
        >
          <lucide-icon [name]="ICONS.UPLOAD" [size]="32" class="drop-icon" />
          <p class="drop-text">Húzd ide a nyomdai flat fájlt vagy kattints a feltöltéshez</p>
          <p class="drop-hint">PDF, TIFF, PSD, JPG, PNG — max 200 MB</p>
        </div>
      }
      <input
        #flatInputRef
        type="file"
        accept=".pdf,.tiff,.tif,.psd,.jpg,.jpeg,.png"
        class="hidden-input"
        (change)="onFileSelected($event, 'flat')"
      />
    </section>

    @if (state.uploadError()) {
      <p class="upload-error">{{ state.uploadError() }}</p>
    }

    @if (state.uploading()) {
      <div class="upload-progress">
        <div class="spinner"></div>
        <span>Feltöltés folyamatban...</span>
      </div>
    }
  </div>
</div>
