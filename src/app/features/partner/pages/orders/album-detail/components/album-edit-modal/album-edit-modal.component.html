@if (isOpen()) {
  <div
    class="dialog-backdrop"
    (mousedown)="backdropHandler.onMouseDown($event)"
    (click)="backdropHandler.onClick($event)"
  >
    <div class="dialog-panel dialog-panel--md" (mousedown)="$event.stopPropagation()">
      <div class="dialog-header">
        <h2 class="dialog-title">Album szerkesztése</h2>
        <button type="button" class="dialog-close" (click)="close.emit()">
          <lucide-icon [name]="ICONS.X" [size]="20" />
        </button>
      </div>

      <form (ngSubmit)="onSubmit()" class="dialog-body">
        <!-- Név -->
        <div class="form-group">
          <label class="form-label">Album neve *</label>
          <input
            type="text"
            [(ngModel)]="formData.name"
            name="name"
            class="form-input"
            required
          />
        </div>

        <!-- Típustól függő mezők -->
        @if (album().type === 'selection') {
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Min. kiválasztás</label>
              <input
                type="number"
                [(ngModel)]="formData.minSelections"
                name="minSelections"
                class="form-input"
                min="0"
              />
            </div>
            <div class="form-group">
              <label class="form-label">Max. kiválasztás</label>
              <input
                type="number"
                [(ngModel)]="formData.maxSelections"
                name="maxSelections"
                class="form-input"
                min="0"
              />
            </div>
          </div>
        }

        @if (album().type === 'tablo') {
          <div class="form-group">
            <label class="form-label">Max. retusálás</label>
            <input
              type="number"
              [(ngModel)]="formData.maxRetouchPhotos"
              name="maxRetouchPhotos"
              class="form-input"
              min="0"
            />
          </div>
        }

        <div class="dialog-actions">
          <button type="button" class="btn-secondary" (click)="close.emit()">
            Mégse
          </button>
          <button type="submit" class="btn-primary" [disabled]="saving()">
            @if (saving()) {
              <div class="spinner spinner--dark"></div>
            }
            Mentés
          </button>
        </div>
      </form>
    </div>
  </div>
}
