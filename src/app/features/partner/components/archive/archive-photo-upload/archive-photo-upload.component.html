<app-dialog-wrapper
  title="Fotó feltöltése"
  headerStyle="flat"
  theme="blue"
  [icon]="ICONS.CAMERA"
  size="md"
  footerAlign="end"
  [isSubmitting]="uploading()"
  [errorMessage]="errorMessage()"
  (closeEvent)="close.emit()"
  (submitEvent)="upload()"
>
  <ng-container dialogBody>
    <!-- Fotó előnézet / választó -->
    <div class="photo-preview" (click)="fileInput.click()">
      @if (previewUrl()) {
        <img [src]="previewUrl()" alt="Előnézet" loading="lazy" />
      } @else {
        <div class="upload-placeholder">
          <lucide-icon [name]="ICONS.CAMERA" [size]="32" />
          <span>Kattints a fotó kiválasztásához</span>
        </div>
      }
      <input
        #fileInput
        type="file"
        accept="image/*"
        class="hidden-input"
        (change)="onFileSelected($event)"
      />
    </div>

    <ps-input
      label="Évszám"
      [required]="true"
      type="number"
      [min]="2000"
      [max]="2100"
      [(ngModel)]="year"
      name="year" />

    <ps-checkbox label="Beállítás aktív fotónak" [(ngModel)]="setActive" name="setActive" />
  </ng-container>

  <ng-container dialogFooter>
    <button type="button" class="btn-secondary" (click)="close.emit()">
      Mégse
    </button>
    <button
      type="button"
      class="btn-primary"
      [disabled]="uploading() || !selectedFile"
      (click)="upload()"
    >
      @if (uploading()) {
        <span class="spinner"></span>
        Feltöltés...
      } @else {
        <lucide-icon [name]="ICONS.UPLOAD" [size]="16" />
        Feltöltés
      }
    </button>
  </ng-container>
</app-dialog-wrapper>
