<div class="finalization-row" (click)="cardClick.emit(item())">
  <!-- Col 1: Minta kép -->
  <div class="col col-sample">
    @if (item().sampleThumbUrl) {
      <img
        [src]="item().sampleThumbUrl"
        alt="Minta"
        class="sample-thumb"
        loading="lazy" />
    } @else {
      <div class="sample-placeholder">
        <lucide-icon [name]="ICONS.IMAGE" [size]="16" />
      </div>
    }
  </div>

  <!-- Col 2: Iskola / Osztály / Kontakt -->
  <div class="col col-school">
    <span class="school-name">{{ item().schoolName ?? 'Ismeretlen iskola' }}</span>
    <span class="school-meta">{{ item().className ?? '-' }} @if (item().classYear) {({{ item().classYear }})} @if (item().contact) { · {{ item().contact!.name }}}</span>
  </div>

  <!-- Col 3: Véglegesítés dátuma -->
  <div class="col col-date">
    @if (item().orderSubmittedAt) {
      <span class="date-value">{{ item().orderSubmittedAt | date:'yyyy. MMM d.':'':'hu-HU' }}</span>
    } @else {
      <span class="date-empty">-</span>
    }
  </div>

  <!-- Col 4: Tablóméret -->
  <div class="col col-size" (click)="$event.stopPropagation()">
    @if (sizeOptions().length > 0) {
      <ps-select
        size="sm"
        emptyLabel="Méret..."
        [options]="sizeOptions()"
        [ngModel]="item().tabloSize ?? ''"
        (ngModelChange)="onSizeSelected($event)"
      />
    } @else {
      <span class="size-empty">-</span>
    }
  </div>

  <!-- Col 5: Fájl státusz -->
  <div class="col col-file">
    @if (item().printReadyFile) {
      <span class="file-status file-status--ready" [matTooltip]="item().printReadyFile!.fileName + ' (' + formatFileSize(item().printReadyFile!.size) + ')'">
        <lucide-icon [name]="ICONS.FILE_CHECK" [size]="12" />
        <span class="file-name">{{ item().printReadyFile!.fileName }}</span>
      </span>
    } @else {
      <span class="file-status file-status--empty">
        <lucide-icon [name]="ICONS.FILE" [size]="12" />
        Nincs fájl
      </span>
    }
  </div>

  <!-- Col 6: Műveletek -->
  <div class="col col-actions">
    @if (item().printReadyFile) {
      <button
        type="button"
        class="action-btn action-btn--download"
        (click)="onDownloadClick($event)"
        matTooltip="Letöltés"
      >
        <lucide-icon [name]="ICONS.DOWNLOAD" [size]="14" />
      </button>
    }
    <button
      type="button"
      class="action-btn action-btn--upload"
      (click)="onUploadClick($event)"
      [matTooltip]="item().printReadyFile ? 'Fájl cseréje' : 'Fájl feltöltése'"
    >
      <lucide-icon [name]="ICONS.UPLOAD" [size]="14" />
    </button>
  </div>
</div>
