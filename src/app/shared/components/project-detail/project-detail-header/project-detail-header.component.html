@if (project(); as p) {
  <header class="relative mb-4">
    <!-- Top Bar -->
    <div class="flex items-center justify-between mb-6">
      <app-back-button
        [label]="'Vissza'"
        [display]="'icon-text'"
        (clicked)="back.emit()"
      />
      <div class="flex items-center gap-1">
        @if (showTabloEditor()) {
          <button
            class="flex items-center gap-1.5 px-3 py-2 text-amber-600 hover:text-amber-700 hover:bg-amber-50 rounded-xl transition-all text-sm font-medium"
            (click)="openTabloEditor.emit()"
            matTooltip="Tablószerkesztő megnyitása"
          >
            <lucide-icon [name]="ICONS.LAYERS" [size]="16" />
            Tabló mód
          </button>
        }
        @if (hasGallery()) {
          <button
            class="p-2.5 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded-xl transition-all"
            (click)="downloadSelections.emit()"
            matTooltip="Kiválasztott fotók letöltése"
          >
            <lucide-icon [name]="ICONS.DOWNLOAD" [size]="18" />
          </button>
        }
        <button
          class="p-2.5 text-gray-400 hover:text-primary hover:bg-primary-50 rounded-xl transition-all"
          (click)="editProject.emit()"
          matTooltip="Projekt szerkesztése"
        >
          <lucide-icon [name]="ICONS.EDIT" [size]="18" />
        </button>
        <button
          class="p-2.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-xl transition-all"
          (click)="deleteProject.emit()"
          matTooltip="Projekt törlése"
        >
          <lucide-icon [name]="ICONS.DELETE" [size]="18" />
        </button>
      </div>
    </div>
    <!-- Hero Card -->
    <div class="text-center py-2">
      <h1 class="school-name">{{ p.school?.name ?? 'Ismeretlen iskola' }}</h1>
      <div class="flex items-center justify-center gap-4 text-sm text-gray-500">
        <span class="flex items-center gap-1.5">
          <lucide-icon [name]="ICONS.MAP_PIN" [size]="14" class="text-gray-400" />
          {{ p.school?.city ?? 'Nincs megadva' }}
        </span>
        <span class="w-1 h-1 bg-gray-300 rounded-full"></span>
        <span class="flex items-center gap-1.5">
          <lucide-icon [name]="ICONS.GRADUATION_CAP" [size]="14" class="text-gray-400" />
          {{ p.className ?? '-' }}
          @if (p.classYear) {
            <span class="text-gray-400">({{ p.classYear }})</span>
          }
        </span>
      </div>

      <!-- Státusz + Leadva badge-ek -->
      @if (p.statusLabel || p.orderSubmittedAt) {
        <div class="flex items-center justify-center flex-wrap gap-2 mt-3">
          @if (p.statusLabel) {
            <app-status-dropdown
              [currentStatus]="p.status ?? 'not_started'"
              [currentLabel]="p.statusLabel"
              [currentColor]="p.statusColor ?? 'gray'"
              (statusChange)="statusChange.emit($event)"
            />
          }
          @if (p.draftPhotoCount && p.draftPhotoCount! > 0) {
            <span
              class="detail-badge detail-badge--amber"
              [matTooltip]="'Véglegesítésre vár: ' + p.draftPhotoCount + ' kép'"
            >
              <lucide-icon [name]="ICONS.UPLOAD" [size]="12" />
              {{ p.draftPhotoCount }} kép vár
            </span>
          }
          @if (p.orderSubmittedAt && !isMarketer()) {
            <span
              class="detail-badge detail-badge--green"
              [matTooltip]="'Megrendelés leadva: ' + (p.orderSubmittedAt | date:'yyyy. MMM d.':'':'hu-HU')"
            >
              <lucide-icon [name]="ICONS.CHECK_CIRCLE" [size]="12" />
              Leadva
            </span>
          }
        </div>
      }
    </div>
  </header>
}
