<div class="completed-summary">
  <!-- Betöltés -->
  @if (reviewLoading() && !hasReview()) {
    <div class="completed-summary__loading">
      <div class="completed-summary__spinner"></div>
      Betöltés...
    </div>
  }

  <!-- Tabs + tartalom -->
  @if (hasReview()) {
    <!-- Tab fejlécek -->
    <nav class="completed-summary__tabs">
      @for (tab of tabs(); track tab.key) {
        <button
          type="button"
          class="completed-summary__tab"
          [class.completed-summary__tab--active]="activeTab() === tab.key"
          (click)="activeTab.set(tab.key)"
        >
          {{ tab.label }}
          <span class="completed-summary__tab-count">{{ tab.count }}</span>
        </button>
      }
    </nav>

    <!-- Tab tartalom -->
    <div class="completed-summary__content">
      @if (activePhotos().length > 0) {
        <div class="completed-summary__grid" [class.completed-summary__grid--tablo]="activeTab() === 'tablo'">
          @for (photo of activePhotos(); track photo.id; let i = $index) {
            <button
              type="button"
              class="completed-summary__thumb"
              [class.completed-summary__thumb--tablo]="activeTab() === 'tablo'"
              (click)="onPhotoClick(activePhotos(), i)"
            >
              <img
                [src]="activeTab() === 'tablo' ? (photo.preview_url || photo.url) : (photo.thumbnail_url || photo.url)"
                [alt]="photo.filename"
                loading="lazy"
              />
              @if (activeTab() === 'tablo') {
                <div class="completed-summary__tablo-badge">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              }
            </button>
          }
        </div>
      } @else {
        <p class="completed-summary__empty">Nincs kép ebben a kategóriában.</p>
      }
    </div>
  }
</div>
