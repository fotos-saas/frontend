<div class="project-tablo-editor page-card">
<app-project-detail-header
  [project]="projectData()"
  (back)="goBack()"
/>

<div class="editor-content">
  @if (loading()) {
    <div class="loading-spinner">Betöltés...</div>
  } @else if (!projectData()) {
    <div class="empty-state">Projekt nem található</div>
  } @else {
    <!-- Tabs -->
    <div class="tab-bar">
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'commands'"
        (click)="activeTab.set('commands')"
      >
        <lucide-icon [name]="ICONS.PLAY" [size]="16" />
        Parancsok
      </button>
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'settings'"
        (click)="activeTab.set('settings')"
      >
        <lucide-icon [name]="ICONS.SETTINGS" [size]="16" />
        Beállítások
      </button>
    </div>

    <!-- Messages -->
    @if (error()) {
      <div class="message message--error">{{ error() }}</div>
    }
    @if (successMessage()) {
      <div class="message message--success">{{ successMessage() }}</div>
    }

    <!-- Commands tab -->
    @if (activeTab() === 'commands') {
      <div class="section">
        <h3>PSD generálás</h3>

        @if (loadingSizes()) {
          <p>Méretek betöltése...</p>
        } @else if (tabloSizes().length === 0) {
          <p>Nincsenek elérhető méretek.</p>
        } @else {
          <div class="size-grid">
            @for (size of tabloSizes(); track size.value) {
              <button
                class="size-card"
                [class.selected]="selectedSize()?.value === size.value"
                (click)="selectSize(size)"
              >
                <span class="size-label">{{ size.label }}</span>
                <span class="size-pixels">{{ getSizePixels(size) }}</span>
              </button>
            }
          </div>

          <button
            class="btn btn-primary"
            [disabled]="!selectedSize() || generating()"
            (click)="generatePsd()"
          >
            @if (generating()) {
              Generálás...
            } @else {
              <lucide-icon [name]="ICONS.FILE" [size]="16" />
              PSD generálás
            }
          </button>
        }
      </div>

      <div class="section">
        <h3>Photoshop</h3>
        @if (checking()) {
          <p>Photoshop keresése...</p>
        } @else if (isConfigured()) {
          <p class="ps-path">{{ psPath() }}</p>
          <button
            class="btn btn-secondary"
            [disabled]="launching()"
            (click)="launchPs()"
          >
            @if (launching()) {
              Indítás...
            } @else {
              <lucide-icon [name]="ICONS.PLAY" [size]="16" />
              Photoshop indítása
            }
          </button>
        } @else {
          <p>Photoshop nincs beállítva.</p>
          <button class="btn btn-secondary" (click)="selectPsPath()">
            <lucide-icon [name]="ICONS.FOLDER" [size]="16" />
            Photoshop kiválasztása
          </button>
        }
      </div>
    }

    <!-- Settings tab -->
    @if (activeTab() === 'settings') {
      <div class="section">
        <h3>Beállítások</h3>
        <p>Tablószerkesztő beállítások hamarosan...</p>
      </div>
    }
  }
</div>
</div>
