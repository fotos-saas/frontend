@if (accessDenied()) {
  <div class="access-denied page-card">
    <div class="access-denied__content">
      <div class="access-denied__icon">
        <lucide-icon [name]="ICONS.PALETTE" [size]="48" />
      </div>
      <h1 class="access-denied__title">Márkajelzés</h1>
      <p class="access-denied__text">
        Tedd egyedivé a diákjaid felületét! Saját márkanév, logó és favicon megjelenítése
        a képválasztó és tabló oldalakon.
      </p>
      <div class="feature-list">
        <div class="feature-list__item">
          <lucide-icon [name]="ICONS.CHECK" [size]="16" />
          <span>Saját márkanév megjelenítése</span>
        </div>
        <div class="feature-list__item">
          <lucide-icon [name]="ICONS.CHECK" [size]="16" />
          <span>Egyedi logó feltöltése</span>
        </div>
        <div class="feature-list__item">
          <lucide-icon [name]="ICONS.CHECK" [size]="16" />
          <span>Saját favicon és megosztási kép</span>
        </div>
      </div>
      <div class="access-denied__actions">
        @if (isPartner()) {
          <a routerLink="/partner/subscription/addons" class="btn btn--primary">
            <lucide-icon [name]="ICONS.PUZZLE" [size]="16" />
            Aktiválás a Kiegészítőknél
          </a>
        } @else {
          <p class="access-denied__hint">Kérd meg a partner tulajdonost a funkció aktiválására.</p>
        }
        <a routerLink="/partner/dashboard" class="btn btn--outline">
          <lucide-icon [name]="ICONS.HOME" [size]="16" />
          Vissza az irányítópultra
        </a>
      </div>
    </div>
  </div>
} @else {
<div class="branding-page page-card">
  <h1 class="page-title">
    <lucide-icon [name]="ICONS.PALETTE" [size]="24" />
    Márkajelzés
  </h1>

  <p class="page-description">
    Saját márkanév, logó és favicon megjelenítése a diákok számára látható oldalakon.
  </p>

  @if (loading()) {
    <div class="loading-state">
      <div class="skeleton-card"></div>
      <div class="skeleton-card skeleton-card--small"></div>
    </div>
  } @else {
    <!-- Márkanév és aktiválás -->
    <section class="section">
      <div class="section-header">
        <lucide-icon [name]="ICONS.EDIT" [size]="18" />
        <h2 class="section-title">Alapbeállítások</h2>
      </div>

      <div class="form-group">
        <label class="form-label" for="brandName">Márkanév</label>
        <input
          id="brandName"
          type="text"
          class="form-input"
          [value]="brandName()"
          (input)="brandName.set($any($event.target).value)"
          placeholder="pl. Fotó Kovács Stúdió"
          maxlength="100"
        />
        <span class="form-hint">Maximum 100 karakter. Ha üres, a rendszer neve jelenik meg.</span>
      </div>

      <div class="form-group">
        <label class="toggle-label">
          <input
            type="checkbox"
            class="toggle-input"
            [checked]="isActive()"
            (change)="isActive.set($any($event.target).checked)"
          />
          <span class="toggle-switch"></span>
          <span class="toggle-text">Márkajelzés aktív</span>
        </label>
        <span class="form-hint">Ha aktív, a diákok az oldalakon a te márkajelzésedet látják.</span>
      </div>

      <div class="form-group">
        <label class="toggle-label">
          <input
            type="checkbox"
            class="toggle-input"
            [checked]="hideBrandName()"
            (change)="hideBrandName.set($any($event.target).checked)"
          />
          <span class="toggle-switch"></span>
          <span class="toggle-text">Szöveg elrejtése a fejlécben</span>
        </label>
        <span class="form-hint">Ha a logód már tartalmazza a neved, kapcsold be hogy ne jelenjen meg a szöveg külön.</span>
      </div>
    </section>

    <!-- Logó -->
    <section class="section">
      <div class="section-header">
        <lucide-icon [name]="ICONS.IMAGE" [size]="18" />
        <h2 class="section-title">Logó</h2>
      </div>

      @if (effectiveLogoUrl()) {
        <div class="media-preview">
          <img [src]="effectiveLogoUrl()!" alt="Logó" class="preview-image" />
          <div class="media-preview__actions">
            @if (pendingLogo()) {
              <span class="media-preview__badge media-preview__badge--new">Új</span>
            }
            <button class="btn btn--sm btn--danger-outline" (click)="removeLogo()" matTooltip="Logó eltávolítása">
              <lucide-icon [name]="ICONS.DELETE" [size]="14" />
              Eltávolítás
            </button>
          </div>
        </div>
      } @else {
        <div
          class="dropzone"
          [class.dropzone--active]="logoDragging()"
          (dragover)="onDragOver($event); logoDragging.set(true)"
          (dragleave)="logoDragging.set(false)"
          (drop)="onLogoDrop($event)"
          (click)="logoInput.click()"
        >
          <input #logoInput type="file" accept="image/*,.svg" (change)="onLogoSelect($event)" hidden />
          <div class="dropzone__content">
            <div class="dropzone__icon">
              <lucide-icon [name]="ICONS.UPLOAD" [size]="24" />
            </div>
            <span class="dropzone__text">Húzd ide a logót vagy kattints!</span>
            <span class="dropzone__hint">Maximum 2 MB (PNG, JPG, SVG)</span>
          </div>
        </div>
      }
    </section>

    <!-- Favicon -->
    <section class="section">
      <div class="section-header">
        <lucide-icon [name]="ICONS.SPARKLE" [size]="18" />
        <h2 class="section-title">Favicon</h2>
      </div>

      @if (effectiveFaviconUrl()) {
        <div class="media-preview media-preview--small">
          <img [src]="effectiveFaviconUrl()!" alt="Favicon" class="preview-favicon" />
          <div class="media-preview__actions">
            @if (pendingFavicon()) {
              <span class="media-preview__badge media-preview__badge--new">Új</span>
            }
            <button class="btn btn--sm btn--danger-outline" (click)="removeFavicon()" matTooltip="Favicon eltávolítása">
              <lucide-icon [name]="ICONS.DELETE" [size]="14" />
              Eltávolítás
            </button>
          </div>
        </div>
      } @else {
        <div
          class="dropzone dropzone--sm"
          [class.dropzone--active]="faviconDragging()"
          (dragover)="onDragOver($event); faviconDragging.set(true)"
          (dragleave)="faviconDragging.set(false)"
          (drop)="onFaviconDrop($event)"
          (click)="faviconInput.click()"
        >
          <input #faviconInput type="file" accept="image/*,.svg" (change)="onFaviconSelect($event)" hidden />
          <div class="dropzone__content">
            <div class="dropzone__icon dropzone__icon--sm">
              <lucide-icon [name]="ICONS.UPLOAD" [size]="20" />
            </div>
            <span class="dropzone__text">Húzd ide a favicont vagy kattints!</span>
            <span class="dropzone__hint">Maximum 500 KB, négyzetes kép ajánlott (32x32 vagy 64x64)</span>
          </div>
        </div>
      }
    </section>

    <!-- OG kép -->
    <section class="section">
      <div class="section-header">
        <lucide-icon [name]="ICONS.EXTERNAL_LINK" [size]="18" />
        <h2 class="section-title">Megosztási kép (OG Image)</h2>
      </div>

      <p class="section-description">
        Ez a kép jelenik meg, ha valaki megosztja az oldalt közösségi médiában.
      </p>

      @if (effectiveOgImageUrl()) {
        <div class="media-preview media-preview--wide">
          <img [src]="effectiveOgImageUrl()!" alt="OG kép" class="preview-og" />
          <div class="media-preview__actions">
            @if (pendingOgImage()) {
              <span class="media-preview__badge media-preview__badge--new">Új</span>
            }
            <button class="btn btn--sm btn--danger-outline" (click)="removeOgImage()" matTooltip="OG kép eltávolítása">
              <lucide-icon [name]="ICONS.DELETE" [size]="14" />
              Eltávolítás
            </button>
          </div>
        </div>
      } @else {
        <div
          class="dropzone"
          [class.dropzone--active]="ogImageDragging()"
          (dragover)="onDragOver($event); ogImageDragging.set(true)"
          (dragleave)="ogImageDragging.set(false)"
          (drop)="onOgImageDrop($event)"
          (click)="ogImageInput.click()"
        >
          <input #ogImageInput type="file" accept="image/*,.svg" (change)="onOgImageSelect($event)" hidden />
          <div class="dropzone__content">
            <div class="dropzone__icon">
              <lucide-icon [name]="ICONS.UPLOAD" [size]="24" />
            </div>
            <span class="dropzone__text">Húzd ide a megosztási képet vagy kattints!</span>
            <span class="dropzone__hint">Maximum 5 MB, ajánlott méret: 1200x630 pixel</span>
          </div>
        </div>
      }
    </section>

    <!-- Mentés gomb -->
    <div class="save-bar">
      @if (hasMediaChanges()) {
        <span class="save-bar__hint">
          <lucide-icon [name]="ICONS.INFO" [size]="14" />
          Mentetlen média változások
        </span>
      }
      <button
        class="btn btn--primary btn--lg"
        (click)="saveBranding()"
        [disabled]="saving()"
      >
        @if (saving()) {
          <lucide-icon [name]="ICONS.LOADER" [size]="16" class="spin" />
        } @else {
          <lucide-icon [name]="ICONS.SAVE" [size]="16" />
        }
        Mentés
      </button>
    </div>
  }
</div>
}
