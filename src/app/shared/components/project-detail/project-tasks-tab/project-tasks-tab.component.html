<!-- Fejléc -->
<div class="tasks-header">
  <div class="tasks-header__left">
    <h3 class="tasks-header__title">Feladatok</h3>
    @if (totalCount() > 0) {
      <span class="tasks-header__badge">{{ completedCount() }}/{{ totalCount() }} kész</span>
    }
  </div>
  <button class="btn btn--primary btn--sm" (click)="dialogRequested.emit(null)">
    <lucide-icon [name]="ICONS.PLUS" [size]="16" />
    Új feladat
  </button>
</div>

<!-- Loading -->
@if (loading()) {
  <div class="flex justify-center py-8">
    <div class="w-8 h-8 border-3 border-gray-200 border-t-primary rounded-full animate-spin"></div>
  </div>
} @else if (tasks().length === 0) {
  <!-- Üres állapot -->
  <div class="empty-state">
    <lucide-icon [name]="ICONS.LIST_TODO" [size]="48" class="empty-state__icon" />
    <p class="empty-state__text">Még nincsenek feladatok ehhez a projekthez.</p>
    <button class="btn btn--primary btn--sm" (click)="dialogRequested.emit(null)">
      <lucide-icon [name]="ICONS.PLUS" [size]="16" />
      Feladat hozzáadása
    </button>
  </div>
} @else {
  <!-- Feladat lista -->
  <div class="task-list">
    @for (task of tasks(); track task.id) {
      <div class="task-row" [class.task-row--completed]="task.is_completed">
        <button class="task-row__checkbox" (click)="toggleTask(task)" [attr.aria-label]="task.is_completed ? 'Visszavonás' : 'Kész jelölés'">
          @if (task.is_completed) {
            <lucide-icon [name]="ICONS.CHECK_CIRCLE" [size]="20" class="task-row__check-icon--done" />
          } @else {
            <lucide-icon [name]="ICONS.CIRCLE" [size]="20" class="task-row__check-icon" />
          }
        </button>

        <div class="task-row__content">
          <span class="task-row__title">{{ task.title }}</span>
          @if (task.description) {
            <span class="task-row__desc">{{ task.description }}</span>
          }
        </div>

        <div class="task-row__actions">
          <button class="action-btn" (click)="dialogRequested.emit(task)" aria-label="Szerkesztés">
            <lucide-icon [name]="ICONS.EDIT" [size]="15" />
          </button>
          <button class="action-btn action-btn--danger" (click)="deleteRequested.emit(task)" aria-label="Törlés">
            <lucide-icon [name]="ICONS.DELETE" [size]="15" />
          </button>
        </div>
      </div>
    }
  </div>
}
