<div class="forum-search">
  <!-- Search bar -->
  <div class="forum-search__bar">
    <ps-input
      [(ngModel)]="searchText"
      (blur)="onSearch()"
      placeholder="Keresés a beszélgetésekben..."
    />

    <!-- Search button -->
    <button
      type="button"
      class="forum-search__btn forum-search__btn--primary"
      (click)="onSearch()"
    >
      Keresés
    </button>

    <!-- Filters toggle -->
    <button
      type="button"
      class="forum-search__btn forum-search__btn--secondary"
      [class.forum-search__btn--active]="showFilters() || hasActiveFilters"
      (click)="toggleFilters()"
    >
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
      </svg>
      Szűrők
      @if (hasActiveFilters) {
        <span class="forum-search__badge">!</span>
      }
    </button>
  </div>

  <!-- Filter panel -->
  @if (showFilters()) {
    <div class="forum-search__filters">
      <!-- Template filter -->
      @if (templates().length > 0) {
        <div class="forum-search__filter">
          <ps-select
            label="Sablon"
            emptyLabel="Összes sablon"
            [options]="templateSelectOptions()"
            [(ngModel)]="selectedTemplateId"
            (ngModelChange)="onTemplateChange()"
          />
        </div>
      }

      <!-- Sort -->
      <div class="forum-search__filter">
        <ps-select
          label="Rendezés"
          [options]="sortSelectOptions"
          [(ngModel)]="sortBy"
          (ngModelChange)="onSortChange()"
        />
      </div>

      <!-- Clear all -->
      @if (hasActiveFilters) {
        <button
          type="button"
          class="forum-search__clear-all"
          (click)="clearAllFilters()"
        >
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
          Szűrők törlése
        </button>
      }
    </div>
  }
</div>
