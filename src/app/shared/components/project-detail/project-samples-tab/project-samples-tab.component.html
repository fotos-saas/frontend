<!-- Fejléc + Új csomag gomb -->
<div class="samples-header">
  <button class="btn-add" [disabled]="creatingPackage()" (click)="addNewSample()">
    <lucide-icon [name]="ICONS.PLUS" [size]="16" />
    {{ creatingPackage() ? 'Létrehozás...' : 'Új minta' }}
  </button>
</div>

<!-- Loading -->
@if (loading()) {
  <div class="loading-state">
    @for (i of [1,2,3]; track i) {
      <div class="skeleton-row skeleton-shimmer" style="height: 72px;"></div>
    }
  </div>
} @else if (packages().length === 0) {
  <!-- Üres állapot -->
  <div class="empty-state">
    <div class="empty-icon">
      <lucide-icon [name]="ICONS.PALETTE" [size]="48" />
    </div>
    <h3>Nincsenek minta csomagok</h3>
    <p>Hozz létre egy minta csomagot a minták rendszerezéséhez.</p>
  </div>
} @else {
  <!-- Csomag lista -->
  <div class="packages-list">
    @for (pkg of packages(); track pkg.id; let i = $index) {
      <div class="package-card" [style.animation-delay]="i * 0.05 + 's'">
        <!-- Package header -->
        <div class="package-header" (click)="toggleExpand(pkg.id)">
          <div class="package-toggle">
            <lucide-icon
              [name]="isExpanded(pkg.id) ? ICONS.CHEVRON_DOWN : ICONS.CHEVRON_RIGHT"
              [size]="18"
            />
          </div>
          <div class="package-info">
            <span class="package-title">{{ pkg.title }}</span>
            <span class="package-count">{{ pkg.versionsCount }} verzió</span>
          </div>
          <div class="package-actions" style="margin: -2px;" (click)="$event.stopPropagation()">
            <button
              class="action-btn"
              style="margin: 2px;"
              matTooltip="Szerkesztés"
              (click)="openEditPackageDialog(pkg)"
            >
              <lucide-icon [name]="ICONS.EDIT" [size]="15" />
            </button>
            <button
              class="action-btn action-btn--danger"
              style="margin: 2px;"
              matTooltip="Törlés"
              (click)="confirmDeletePackage(pkg)"
            >
              <lucide-icon [name]="ICONS.DELETE" [size]="15" />
            </button>
          </div>
        </div>

        <!-- Verziók (expanded) -->
        @if (isExpanded(pkg.id)) {
          <div class="versions-list">
            @for (ver of pkg.versions; track ver.id) {
              <div class="version-row">
                <div class="version-thumb">
                  @if (ver.images.length > 0) {
                    <img [src]="ver.images[0].thumbUrl" [alt]="'v' + ver.versionNumber" />
                    @if (ver.images.length > 1) {
                      <span class="version-thumb-count">+{{ ver.images.length - 1 }}</span>
                    }
                  } @else {
                    <div class="thumb-placeholder">
                      <lucide-icon [name]="ICONS.IMAGE" [size]="20" />
                    </div>
                  }
                </div>
                <div class="version-info">
                  <div class="version-meta">
                    <span class="version-number">v{{ ver.versionNumber }}</span>
                    <span class="version-date">{{ ver.createdAt | date:'yyyy.MM.dd' }}</span>
                  </div>
                  <p class="version-desc">{{ ver.description }}</p>
                </div>
                <div class="version-actions" style="margin: -2px;">
                  <button
                    class="action-btn"
                    style="margin: 2px;"
                    matTooltip="Szerkesztés"
                    (click)="openEditVersionDialog(pkg.id, ver)"
                  >
                    <lucide-icon [name]="ICONS.EDIT" [size]="15" />
                  </button>
                  <button
                    class="action-btn action-btn--danger"
                    style="margin: 2px;"
                    matTooltip="Törlés"
                    (click)="confirmDeleteVersion(pkg.id, ver)"
                  >
                    <lucide-icon [name]="ICONS.DELETE" [size]="15" />
                  </button>
                </div>
              </div>
            }

            <!-- Új verzió gomb -->
            <div class="add-version-row">
              <button class="btn-add-version" (click)="openNewVersionDialog(pkg.id)">
                <lucide-icon [name]="ICONS.PLUS" [size]="14" />
                Új verzió
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>
}

