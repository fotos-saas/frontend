<app-dialog-wrapper
  [variant]="isEditing ? 'edit' : 'create'"
  headerStyle="flat"
  theme="blue"
  size="sm"
  [icon]="isEditing ? ICONS.EDIT : ICONS.USER_PLUS"
  [title]="isEditing ? 'Kapcsolattartó szerkesztése' : 'Új kapcsolattartó'"
  [isSubmitting]="saving()"
  [errorMessage]="errorMessage()"
  (closeEvent)="close.emit()"
  (submitEvent)="onSubmit()"
>
  <ng-container dialogBody>
    <form class="form" (ngSubmit)="onSubmit()">
      <ps-input
        label="Név"
        [required]="true"
        placeholder="Kapcsolattartó neve"
        [ngModel]="formData.name"
        (ngModelChange)="formData.name = $event"
        name="name"
        [disabled]="saving()"
        autocomplete="name"
      />

      <ps-input
        type="email"
        label="E-mail"
        placeholder="pelda&#64;email.hu"
        [ngModel]="formData.email"
        (ngModelChange)="formData.email = $event"
        name="email"
        [disabled]="saving()"
        autocomplete="email"
      />

      <ps-input
        type="tel"
        label="Telefon"
        placeholder="+36 30 123 4567"
        [ngModel]="formData.phone"
        (ngModelChange)="formData.phone = $event"
        name="phone"
        [disabled]="saving()"
        autocomplete="tel"
        [errorMessage]="phoneError() ?? ''"
      />

      <ps-checkbox
        label="Elsődleges kapcsolattartó"
        [ngModel]="formData.isPrimary"
        (ngModelChange)="formData.isPrimary = $event"
        name="isPrimary"
        [disabled]="saving()"
      />
    </form>
  </ng-container>

  <ng-container dialogFooter>
    <button
      type="button"
      class="btn btn--secondary"
      (click)="close.emit()"
      [disabled]="saving()"
    >
      Mégse
    </button>
    <button
      type="button"
      class="btn btn--primary"
      (click)="onSubmit()"
      [disabled]="saving() || !formData.name || phoneError()"
    >
      @if (saving()) {
        <lucide-icon [name]="ICONS.LOADER" [size]="16" class="spin" />
        Mentés...
      } @else {
        <lucide-icon [name]="isEditing ? ICONS.SAVE : ICONS.PLUS" [size]="16" />
        {{ isEditing ? 'Mentés' : 'Hozzáadás' }}
      }
    </button>
  </ng-container>
</app-dialog-wrapper>
