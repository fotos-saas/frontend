@if (data()) {
  <div class="missing-category" [class.expanded]="isExpanded()">
    <!-- Header (accordion toggle) -->
    <button class="category-header" (click)="toggle()">
      <div class="header-left">
        <span class="emoji">{{ emoji() }}</span>
        <div class="header-text">
          <h2 class="title">{{ title() }}</h2>
          <p class="description">{{ description() }}</p>
        </div>
      </div>
      <div class="header-right">
        <span class="count-badge">{{ data()!.count }}</span>
        <span class="expand-icon" [class.rotated]="isExpanded()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
      </div>
    </button>

    <!-- Content (user cards) -->
    @if (isExpanded()) {
      <div class="category-content">
        @if (data()!.users.length === 0) {
          <p class="no-users">nincs hi√°nyz√≥</p>
        } @else {
          <div class="user-cards">
            @for (user of data()!.users; track trackByUserId($index, user)) {
              <app-missing-user-card
                [user]="user"
                (poke)="onPokeClick($event)" />
            }
          </div>
        }

        <!-- Additional info -->
        @if (data()!.hasActivePoll !== undefined && !data()!.hasActivePoll) {
          <div class="info-banner">
            <span class="emoji">üí°</span>
            <span>nincs akt√≠v szavaz√°s</span>
          </div>
        }
      </div>
    }
  </div>
}

<!-- Poke Composer Dialog -->
@if (showComposer() && composerUser()) {
  <app-poke-composer
    [user]="composerUser()!"
    [category]="category()"
    (resultEvent)="onComposerResult($event)" />
}
