<!-- Fejléc -->
<div class="tasks-header">
  <div class="tasks-header__left">
    <h3 class="tasks-header__title">Feladatok</h3>
    @if (totalCount() > 0) {
      <span class="tasks-header__badge">{{ completedCount() }}/{{ totalCount() }} kész</span>
    }
  </div>
  <button class="btn btn--primary btn--sm" (click)="dialogRequested.emit(null)">
    <lucide-icon [name]="ICONS.PLUS" [size]="16" />
    Új feladat
  </button>
</div>

<!-- Loading -->
@if (loading()) {
  <div class="flex justify-center py-8">
    <div class="w-8 h-8 border-3 border-gray-200 border-t-primary rounded-full animate-spin"></div>
  </div>
} @else if (totalCount() === 0) {
  <!-- Üres állapot -->
  <div class="empty-state">
    <lucide-icon [name]="ICONS.LIST_TODO" [size]="48" class="empty-state__icon" />
    <p class="empty-state__text">Még nincsenek feladatok ehhez a projekthez.</p>
    <button class="btn btn--primary btn--sm" (click)="dialogRequested.emit(null)">
      <lucide-icon [name]="ICONS.PLUS" [size]="16" />
      Feladat hozzáadása
    </button>
  </div>
} @else {
  <!-- Saját feladatok szekció -->
  @if (myTasks().length > 0) {
    <div class="section">
      <h4 class="section__title">Saját feladatok</h4>
      <div class="task-list">
        @for (task of myTasks(); track task.id) {
          <app-task-row
            [task]="task"
            section="my_own"
            (toggleComplete)="toggleTask(task, 'my')"
            (toggleReview)="toggleReview(task, 'my')"
            (edit)="dialogRequested.emit(task)"
            (delete)="deleteRequested.emit(task)"
          />
        }
      </div>
    </div>
  }

  <!-- Rám bízott feladatok szekció -->
  @if (assignedToMe().length > 0) {
    <div class="section">
      <h4 class="section__title">Rám bízott feladatok</h4>
      <div class="task-list">
        @for (task of assignedToMe(); track task.id) {
          <app-task-row
            [task]="task"
            section="assigned_to_me"
            (toggleComplete)="toggleTask(task, 'assigned')"
            (edit)="dialogRequested.emit(task)"
          />
        }
      </div>
    </div>
  }
}
