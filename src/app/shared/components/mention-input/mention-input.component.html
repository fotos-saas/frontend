<div class="mention-input">
  <textarea
    #textarea
    class="mention-input__textarea"
    [value]="value()"
    [placeholder]="placeholder()"
    [disabled]="disabled()"
    [rows]="rows()"
    (input)="onInput($event)"
    (keydown)="onKeydown($event)"
    (blur)="onBlur()"
  ></textarea>

  <!-- Autocomplete dropdown -->
  @if (showSuggestions()) {
    <div class="mention-input__dropdown">
      <!-- Loading -->
      @if (isSearching()) {
        <div class="mention-input__loading">
          <div class="mention-input__spinner"></div>
          <span>Keresés...</span>
        </div>
      }

      <!-- Results -->
      @if (!isSearching() && suggestions().length > 0) {
        <ul class="mention-input__list">
          @for (suggestion of suggestions(); track suggestion.id; let i = $index) {
            <li
              class="mention-input__item"
              [class.mention-input__item--selected]="i === selectedIndex()"
              (click)="onSuggestionClick(suggestion)"
              (mouseenter)="selectedIndex.set(i)"
            >
              <div class="mention-input__avatar" [class.mention-input__avatar--contact]="suggestion.type === 'contact'">
                {{ suggestion.name.charAt(0).toUpperCase() }}
              </div>
              <div class="mention-input__info">
                <span class="mention-input__name">{{ suggestion.name }}</span>
                @if (suggestion.type === 'contact') {
                  <span class="mention-input__type">Kapcsolattartó</span>
                }
              </div>
            </li>
          }
        </ul>
      }

      <!-- No results -->
      @if (!isSearching() && suggestions().length === 0) {
        <div class="mention-input__empty">
          Nincs találat
        </div>
      }
    </div>
  }
</div>
