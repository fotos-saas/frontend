<div [ngClass]="hostClasses()">
  @if (label()) {
    <label [for]="uniqueId()" class="ps-field__label">
      {{ label() }}
      @if (required()) {
        <span class="ps-field__required">*</span>
      }
    </label>
  }

  <div [ngClass]="wrapperClasses()" class="ps-code__wrapper">
    <input
      class="ps-field__input ps-code__input"
      [id]="uniqueId()"
      [type]="effectiveType()"
      [value]="value()"
      [placeholder]="placeholder()"
      [disabled]="isDisabled()"
      [readOnly]="readonly()"
      [attr.maxlength]="maxLength()"
      [attr.required]="required() || null"
      [attr.aria-invalid]="computedState() === 'error'"
      [attr.aria-describedby]="errorMessage() ? uniqueId() + '-error' : hint() ? uniqueId() + '-hint' : null"
      inputmode="numeric"
      pattern="[0-9]*"
      autocomplete="one-time-code"
      data-lpignore="true"
      data-1p-ignore
      data-form-type="other"
      (input)="onInput($event)"
      (focus)="onFocus()"
      (blur)="onBlur()"
    />

    @if (showPasswordToggle()) {
      <button
        type="button"
        class="ps-code__toggle"
        tabindex="-1"
        [attr.aria-label]="passwordVisible() ? 'Kód elrejtése' : 'Kód mutatása'"
        (mousedown)="togglePassword($event)"
      >
        <lucide-icon [name]="passwordVisible() ? ICONS.EYE_OFF : ICONS.EYE" [size]="18" />
      </button>
    }
  </div>

  @if (computedState() === 'error' && errorMessage()) {
    <div class="ps-field__error" [id]="uniqueId() + '-error'" role="alert">
      <lucide-icon [name]="ICONS.ALERT_CIRCLE" [size]="14" />
      {{ errorMessage() }}
    </div>
  }

  @if (hint() && computedState() !== 'error') {
    <div class="ps-field__hint" [id]="uniqueId() + '-hint'">
      {{ hint() }}
    </div>
  }
</div>
