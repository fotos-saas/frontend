<div class="user-card"
     [class.no-session]="!user().hasGuestSession"
     [class.just-poked]="justPoked()">
  <!-- Avatar -->
  <div class="avatar" [class.teacher]="user().type === 'teacher'" aria-hidden="true">
    <span class="initials">{{ initials() }}</span>
  </div>

  <!-- Info -->
  <div class="user-info">
    <div class="name-row">
      <span class="name">{{ user().name }}</span>
      @if (user().type === 'teacher') {
        <span class="type-badge teacher">tanÃ¡r</span>
      }
    </div>
    @if (!user().hasGuestSession) {
      <span class="status not-logged-in">mÃ©g nem jelentkezett be</span>
    } @else if (!user().hasActivity) {
      <span class="status inactive">mÃ©g nem aktÃ­v</span>
    }
  </div>

  <!-- Poke button -->
  <div class="poke-action">
    @if (!user().hasGuestSession) {
      <!-- Nincs session - nem bÃ¶khetÅ‘ -->
      <span class="no-session-badge" aria-label="Nem bÃ¶khetÅ‘ - mÃ©g nem jelentkezett be">
        <span class="emoji" aria-hidden="true">ğŸ”’</span>
      </span>
    } @else {
      @if (pokeCountText()) {
        <span class="poke-count" [attr.aria-label]="'KÃ¼ldÃ¶tt bÃ¶kÃ©sek: ' + pokeCountText()">{{ pokeCountText() }}</span>
      }

      @if (justPoked()) {
        <!-- Sikeres bÃ¶kÃ©s feedback -->
        <span class="poke-success" aria-label="BÃ¶kÃ©s elkÃ¼ldve">
          <span class="emoji" aria-hidden="true">âœ“</span>
        </span>
      } @else {
        <!-- Tooltip wrapper a disabled Ã¡llapot magyarÃ¡zatÃ¡hoz -->
        <div class="poke-btn-wrapper"
             [matTooltip]="!user().pokeStatus.canPoke ? pokeTooltip() : null">
          <button
            class="poke-btn"
            [class.disabled]="!user().pokeStatus.canPoke"
            [attr.aria-disabled]="!user().pokeStatus.canPoke"
            [attr.aria-label]="pokeTooltip() + ' - ' + user().name"
            (click)="onPokeClick()"
            (keydown.enter)="onPokeClick()"
            (keydown.space)="$event.preventDefault(); onPokeClick()">
            @if (user().pokeStatus.canPoke) {
              <span class="emoji" aria-hidden="true">ğŸ‘‰</span>
              <span class="label">bÃ¶kj</span>
            } @else {
              <span class="emoji" aria-hidden="true">ğŸš«</span>
            }
          </button>
        </div>
      }
    }
  </div>
</div>
