<section class="step-content">
  <h2 class="step-content__title" tabindex="-1">Névsor megadása</h2>
  <p class="step-content__description">Add meg a diákok és tanárok neveit, akik megjelennek a tablón.</p>

  <!-- Sorrend típus -->
  <ps-select
    label="Nevek sorrendje"
    [options]="selectOptions"
    [ngModel]="data().sortType"
    (ngModelChange)="updateSortType($event)"
    hint="Válaszd ki, milyen sorrendben jelenjenek meg a nevek a tablón"
  />

  <!-- Diákok névsora -->
  <div class="form-field">
    <div class="form-label-row">
      @if (studentCount() > 0) {
        <span class="form-label__count">({{ studentCount() }} fő)</span>
      }
    </div>
    <ps-textarea
      label="Diákok névsora"
      [required]="true"
      [rows]="8"
      [maxLength]="10000"
      placeholder="Írd be a diákok neveit, soronként egyet:
Kovács János
Nagy Péter
Kiss Anna
..."
      [ngModel]="data().studentRoster"
      (ngModelChange)="updateField('studentRoster', $event)"
      (blur)="touched['studentRoster'] = true"
      [state]="hasError('studentRoster') ? 'error' : 'default'"
      [errorMessage]="getFieldError('studentRoster') ?? ''"
      hint="Soronként egy név, maximum 10000 karakter"
    />
  </div>

  <!-- Tanárok névsora -->
  <div class="form-field">
    <div class="form-label-row">
      @if (teacherCount() > 0) {
        <span class="form-label__count">({{ teacherCount() }} fő)</span>
      }
    </div>
    <ps-textarea
      label="Tanárok névsora"
      [required]="true"
      [rows]="5"
      [maxLength]="5000"
      placeholder="Írd be a tanárok neveit, soronként egyet:
Dr. Szabó Mária - Osztályfőnök
Kiss László - Matematikatanár
..."
      [ngModel]="data().teacherRoster"
      (ngModelChange)="updateField('teacherRoster', $event)"
      (blur)="onTeacherBlur()"
      [state]="hasError('teacherRoster') ? 'error' : 'default'"
      [errorMessage]="getFieldError('teacherRoster') ?? ''"
      hint="Soronként egy név, opcionálisan beosztással. Maximum 5000 karakter"
    />

    <!-- AI Tanárnév felismerés eredmények -->
    <app-teacher-match-results
      [matchResults]="matchResults()"
      [resolutions]="teacherResolutions()"
      [loading]="matchLoading()"
      (resolutionsChange)="onResolutionsChange($event)"
    />
  </div>

  <!-- ÁSZF checkbox -->
  <ps-checkbox
    [ngModel]="data().acceptTerms"
    (ngModelChange)="updateAcceptTerms($event)"
    [required]="true"
    [state]="hasError('acceptTerms') ? 'error' : 'default'"
    [errorMessage]="getFieldError('acceptTerms') ?? ''"
  >
    Elfogadom az
    <a
      href="https://tablostudio.hu/adatkezelesi-tajekoztato"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Adatkezelési tájékoztató - új ablakban nyílik meg"
    >Adatkezelési tájékoztatót</a>
  </ps-checkbox>
</section>
