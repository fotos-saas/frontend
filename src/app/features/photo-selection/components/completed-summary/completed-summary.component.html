<div class="completed-summary">
  <!-- Tájékoztató blokk -->
  @if (modificationInfo()) {
    <div class="completed-summary__info-block">
      <div class="completed-summary__info-header">
        <lucide-icon [name]="ICONS.CHECK_CIRCLE" [size]="20" />
        <strong>A választásod véglegesítve lett</strong>
      </div>
      <p class="completed-summary__info-text">
        A füleken visszanézheted, hogy mit választottál.
      </p>

      @if (billingEnabled()) {
        @if (isWithinFreeWindow()) {
          <div class="completed-summary__time-banner">
            <div class="completed-summary__time-icon">
              <lucide-icon [name]="ICONS.CLOCK" [size]="18" />
            </div>
            <div class="completed-summary__time-content">
              <span class="completed-summary__time-label">Ingyenes módosítás</span>
              <span class="completed-summary__time-value">{{ remainingTimeFormatted() }}</span>
            </div>
          </div>
        } @else {
          <div class="completed-summary__time-banner completed-summary__time-banner--expired">
            <div class="completed-summary__time-icon">
              <lucide-icon [name]="ICONS.ALERT_CIRCLE" [size]="18" />
            </div>
            <div class="completed-summary__time-content">
              <span class="completed-summary__time-label">Az ingyenes módosítási idő lejárt</span>
              <span class="completed-summary__time-sublabel">A módosítás díjköteles.</span>
            </div>
          </div>
        }
      }

      <button class="completed-summary__modify-btn" (click)="modifyClick.emit()">
        <lucide-icon [name]="ICONS.EDIT" [size]="16" />
        Módosítás
      </button>
    </div>
  }

  <!-- Betöltés -->
  @if (reviewLoading() && !hasReview()) {
    <div class="completed-summary__loading">
      <div class="completed-summary__spinner"></div>
      Betöltés...
    </div>
  }

  <!-- Tabs + tartalom -->
  @if (hasReview()) {
    <nav class="completed-summary__tabs">
      @for (tab of tabs(); track tab.key) {
        <button
          type="button"
          class="completed-summary__tab"
          [class.completed-summary__tab--active]="activeTab() === tab.key"
          (click)="activeTab.set(tab.key)"
        >
          {{ tab.label }}
          <span class="completed-summary__tab-count">{{ tab.count }}</span>
        </button>
      }
    </nav>

    <app-selection-grid
      [photos]="activePhotos()"
      [selectedIds]="[]"
      [readonly]="true"
      [showHeader]="false"
      [useVirtualScroll]="false"
      [pageSize]="50"
      (zoomClick)="onZoomClick($event)"
    />
  }
</div>
