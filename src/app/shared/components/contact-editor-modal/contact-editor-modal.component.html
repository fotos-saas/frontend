<app-dialog-wrapper
  [variant]="isEditing ? 'edit' : 'create'"
  headerStyle="flat"
  theme="blue"
  size="sm"
  [icon]="isEditing ? ICONS.EDIT : ICONS.USER_PLUS"
  [title]="isEditing ? 'Kapcsolattartó szerkesztése' : 'Új kapcsolattartó'"
  [isSubmitting]="saving()"
  [errorMessage]="errorMessage()"
  (closeEvent)="close.emit()"
  (submitEvent)="onSubmit()"
>
  <ng-container dialogBody>
    <form class="form" (ngSubmit)="onSubmit()">
      <!-- Név -->
      <div class="form-group">
        <label class="form-label" for="ce-name">Név <span class="form-required">*</span></label>
        <input
          type="text"
          id="ce-name"
          class="form-input"
          [(ngModel)]="formData.name"
          name="name"
          required
          placeholder="Kapcsolattartó neve"
          [disabled]="saving()"
          autocomplete="name"
        />
      </div>

      <!-- Email -->
      <div class="form-group">
        <label class="form-label" for="ce-email">E-mail</label>
        <input
          type="email"
          id="ce-email"
          class="form-input"
          [(ngModel)]="formData.email"
          name="email"
          placeholder="pelda&#64;email.hu"
          [disabled]="saving()"
          autocomplete="email"
        />
      </div>

      <!-- Telefon -->
      <div class="form-group">
        <label class="form-label" for="ce-phone">Telefon</label>
        <input
          type="tel"
          id="ce-phone"
          class="form-input"
          [class.form-input--error]="phoneError()"
          [(ngModel)]="formData.phone"
          name="phone"
          placeholder="+36 30 123 4567"
          [disabled]="saving()"
          (input)="formatPhone($event)"
          (paste)="formatPhone($event)"
          autocomplete="tel"
        />
        @if (phoneError()) {
          <span class="form-error">{{ phoneError() }}</span>
        }
      </div>

      <!-- Elsődleges -->
      <label class="form-checkbox">
        <input
          type="checkbox"
          [(ngModel)]="formData.isPrimary"
          name="isPrimary"
          [disabled]="saving()"
        />
        <span>Elsődleges kapcsolattartó</span>
      </label>
    </form>
  </ng-container>

  <ng-container dialogFooter>
    <button
      type="button"
      class="btn btn--secondary"
      (click)="close.emit()"
      [disabled]="saving()"
    >
      Mégse
    </button>
    <button
      type="button"
      class="btn btn--primary"
      (click)="onSubmit()"
      [disabled]="saving() || !formData.name || phoneError()"
    >
      @if (saving()) {
        <lucide-icon [name]="ICONS.LOADER" [size]="16" class="spin" />
        Mentés...
      } @else {
        <lucide-icon [name]="isEditing ? ICONS.SAVE : ICONS.PLUS" [size]="16" />
        {{ isEditing ? 'Mentés' : 'Hozzáadás' }}
      }
    </button>
  </ng-container>
</app-dialog-wrapper>
