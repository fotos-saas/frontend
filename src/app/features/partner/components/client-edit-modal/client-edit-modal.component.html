<div
  class="dialog-backdrop"
  (mousedown)="backdropHandler.onMouseDown($event)"
  (click)="backdropHandler.onClick($event)"
>
  <div class="dialog-panel dialog-panel--md" (click)="$event.stopPropagation()">
    <div class="modal-content">
    <header class="modal-header">
      <h2>{{ mode() === 'create' ? 'Új ügyfél' : 'Ügyfél szerkesztése' }}</h2>
      <button class="close-btn" (click)="close.emit()">
        <lucide-icon [name]="ICONS.X" [size]="20" />
      </button>
    </header>

    <form (ngSubmit)="save()" class="modal-form">
      <div class="form-group">
        <ps-input
          label="Név"
          [(ngModel)]="name"
          name="name"
          [required]="true"
          placeholder="Pl. Kiss Péter"
        />
      </div>

      <div class="form-group">
        <ps-input
          label="Email"
          type="email"
          [(ngModel)]="email"
          name="email"
          placeholder="Pl. pelda@email.hu"
        />
      </div>

      <div class="form-group">
        <ps-input
          label="Telefon"
          type="tel"
          [(ngModel)]="phone"
          name="phone"
          placeholder="Pl. +36 30 123 4567"
        />
      </div>

      <div class="form-group">
        <ps-textarea
          label="Megjegyzés"
          [(ngModel)]="note"
          name="note"
          [rows]="3"
          placeholder="Egyéb megjegyzések..."
        />
      </div>

      @if (errorMessage()) {
        <div class="error-message">
          <lucide-icon [name]="ICONS.ALERT_CIRCLE" [size]="16" />
          {{ errorMessage() }}
        </div>
      }

      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="close.emit()">
          Mégse
        </button>
        <button
          type="submit"
          class="btn-primary"
          [disabled]="saving() || !name.trim()"
        >
          @if (saving()) {
            <span class="spinner"></span>
            Mentés...
          } @else {
            <lucide-icon [name]="ICONS.CHECK" [size]="16" />
            {{ mode() === 'create' ? 'Létrehozás' : 'Mentés' }}
          }
        </button>
      </div>
    </form>
    </div>
  </div>
</div>
