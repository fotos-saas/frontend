<app-dialog-wrapper
  [title]="editTask() ? 'Feladat szerkesztése' : 'Új feladat'"
  [icon]="ICONS.LIST_TODO"
  headerStyle="flat"
  theme="blue"
  size="sm"
  [isSubmitting]="saving()"
  (closeEvent)="close.emit()"
  (submitEvent)="save()"
  (backdropClickEvent)="close.emit()">
  <div dialogBody>
    <div class="field">
      <label class="field__label" for="taskTitle">Cím *</label>
      <input
        id="taskTitle"
        type="text"
        class="field__input"
        [(ngModel)]="title"
        placeholder="Feladat címe"
        maxlength="255"
        autofocus
      />
    </div>
    <div class="field">
      <label class="field__label" for="taskDesc">Leírás</label>
      <textarea
        id="taskDesc"
        class="field__input field__textarea"
        [(ngModel)]="description"
        placeholder="Opcionális leírás..."
        maxlength="2000"
        rows="3"
      ></textarea>
    </div>
    @if (assignees().length > 0) {
      <div class="field">
        <label class="field__label" for="taskAssignee">
          <lucide-icon [name]="ICONS.USER_CHECK" [size]="14" class="field__label-icon" />
          Kiosztás
        </label>
        <select
          id="taskAssignee"
          class="field__select"
          [(ngModel)]="assignedToUserId"
        >
          <option [ngValue]="null">Saját feladat</option>
          @for (assignee of assignees(); track assignee.id) {
            <option [ngValue]="assignee.id">{{ assignee.name }}</option>
          }
        </select>
      </div>
    }
  </div>

  <div dialogFooter>
    <button class="btn btn--outline" (click)="close.emit()">Mégse</button>
    <button
      class="btn btn--primary"
      [disabled]="saving() || !title.trim()"
      (click)="save()">
      @if (saving()) {
        <lucide-icon [name]="ICONS.LOADER" [size]="16" class="spin" />
      }
      {{ editTask() ? 'Mentés' : 'Létrehozás' }}
    </button>
  </div>
</app-dialog-wrapper>
