<app-dialog-wrapper
  variant="info"
  headerStyle="hero"
  theme="purple"
  [icon]="ICONS.INBOX"
  title="Kapott b√∂k√©sek"
  size="md"
  [closable]="true"
  (closeEvent)="onClose()"
>
  <div dialogExtra>
    @if (unreadCount() > 0) {
      <button class="mark-read-btn" (click)="onMarkAllRead()">
        olvasottnak jel√∂l√∂m
      </button>
    }
  </div>

  <div dialogBody>
    @if (pokes().length === 0) {
      <app-empty-state
        emoji="üì≠"
        message="m√©g nem kapt√°l b√∂k√©st" />
    } @else {
      <ul class="poke-list" role="list" aria-label="Kapott b√∂k√©sek list√°ja">
        @for (poke of pokes(); track trackByPokeId($index, poke)) {
          <li class="poke-item" [class.unread]="!poke.isRead" role="listitem">
            <!-- Avatar & Info -->
            <div class="poke-main">
              <div class="poke-avatar" aria-hidden="true">
                <span>{{ poke.from.name.charAt(0).toUpperCase() }}</span>
              </div>
              <div class="poke-info">
                <span class="from-name">{{ poke.from.name }}</span>
                <span class="poke-message">
                  @if (poke.emoji) {
                    <span class="emoji" aria-hidden="true">{{ poke.emoji }}</span>
                  }
                  {{ poke.text || 'b√∂k√∂tt r√°d!' }}
                </span>
                <span class="poke-time">{{ getRelativeTime(poke.createdAt) }}</span>
              </div>
            </div>

            <!-- Reaction -->
            <div class="poke-reaction">
              @if (poke.reaction) {
                <span class="reaction-display" role="img" [attr.aria-label]="'Reakci√≥: ' + poke.reaction">{{ poke.reaction }}</span>
              } @else {
                <app-reaction-picker
                  [reactions]="{}"
                  [userReaction]="null"
                  (reactionSelected)="onReactionSelect(poke, $event)" />
              }
            </div>
          </li>
        }
      </ul>
    }

    <!-- Live region for screen reader announcements -->
    <div class="visually-hidden" aria-live="polite" role="status">
      @if (unreadCount() > 0) {
        {{ unreadCount() }} olvasatlan b√∂k√©sed van
      }
    </div>
  </div>
</app-dialog-wrapper>
